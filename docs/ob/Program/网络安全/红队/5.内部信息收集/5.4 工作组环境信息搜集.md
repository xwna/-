### 5.4 工作组环境信息搜集

#### 5.4.1 基于MSF发现内网存活主机（1）

攻击机： 192.168.1.5 Debian

靶机： 192.168.1.2 Windows 7

192.168.1.119 Windows 2003

**MSF的search支持type搜索：**

    msf > search scanner type:auxiliary 
    
    Matching Modules
    ================ 
    
    Name Disclosure Date Rank Check Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐ ‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    auxiliary/admin/appletv/appletv_display_image normal No Apple TV Image Remote Control
    auxiliary/admin/appletv/appletv_display_video normal No Apple TV Video Remote Control
    auxiliary/admin/smb/check_dir_file normal Yes SMB Scanner CheckFile/Directory Utility
    auxiliary/admin/teradata/teradata_odbc_sql 2018‐03‐29 normal Yes Teradata ODBC SQL Query Module
    auxiliary/bnat/bnat_scan normal Yes BNAT Scanner
    auxiliary/gather/citrix_published_applications normal No Citrix MetaFrame ICA Published Applications Scanner
    auxiliary/gather/enum_dns normal No DNS Record Scanner and Enumerator
    ....
    auxiliary/scanner/winrm/winrm_cmd normal Yes WinRM Command Runner
    auxiliary/scanner/winrm/winrm_login normal Yes WinRM Login Utility
    auxiliary/scanner/winrm/winrm_wql normal Yes WinRM WQL Query Runner
    auxiliary/scanner/wproxy/att_open_proxy 2017‐08‐31 normal Yes Open WAN‐to‐LAN proxy on AT&T routers
    auxiliary/scanner/wsdd/wsdd_query normal Yes WS‐Discovery Information Discovery
    auxiliary/scanner/x11/open_x11 normal Yes X11 No‐Auth Scanner
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002222657272.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

    第一季主要介绍 scanner 下的五个模块，辅助发现内网存活主机，分别为：
    auxiliary/scanner/discovery/arp_sweep 
    auxiliary/scanner/discovery/udp_sweep
    auxiliary/scanner/ftp/ftp_version 
    auxiliary/scanner/http/http_version
    auxiliary/scanner/smb/smb_version
    
        

**1、基于scanner/http/http\_version发现HTTP服务**

    msf auxiliary(scanner/http/http_version) > show options 
    ​
    Module options (auxiliary/scanner/http/http_version): 
    ​
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    Proxies no A proxy chain of format type:host:port[,type:host:port] [...]
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    RPORT 80 yes The target port (TCP)
    SSL false no Negotiate SSL/TLS for outgoing connections
    THREADS 20 yes The number of concurrent threads
    VHOST no HTTP server virtual host 
    ​
    msf auxiliary(scanner/http/http_version) > exploit 
    ​
    [+] 192.168.1.1:80
    [*] Scanned 27 of 256 hosts (10% complete)
    [*] Scanned 63 of 256 hosts (24% complete)
    [*] Scanned 82 of 256 hosts (32% complete)
    [*] Scanned 103 of 256 hosts (40% complete)
    [+] 192.168.1.119:80 Microsoft‐IIS/6.0 ( Powered by ASP.NET )
    [*] Scanned 129 of 256 hosts (50% complete)
    [*] Scanned 154 of 256 hosts (60% complete)
    [*] Scanned 182 of 256 hosts (71% complete)
    [*] Scanned 205 of 256 hosts (80% complete)
    [*] Scanned 231 of 256 hosts (90% complete)
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002222824545.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

**2、基于scanner/smb/smb\_version发现SMB服务**

    msf auxiliary(scanner/smb/smb_version) > show options 
    
    Module options (auxiliary/scanner/smb/smb_version): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    SMBDomain . no The Windows domain to use for authentication
    SMBPass no The password for the specified username
    SMBUser no The username to authenticate as
    THREADS 20 yes The number of concurrent threads 
    
    msf auxiliary(scanner/smb/smb_version) > exploit 
    
    [+] 192.168.1.2:445 ‐ Host is running Windows 7 Ultimate SP1 (build:7601) (name:JOHN‐PC) (workgroup:WORKGROUP )
    [*] Scanned 40 of 256 hosts (15% complete)
    [*] Scanned 60 of 256 hosts (23% complete)
    [*] Scanned 79 of 256 hosts (30% complete)
    [+] 192.168.1.119:445 ‐ Host is running Windows 2003 R2 SP2 (build:3790) (name:WIN03X64)
    [*] Scanned 103 of 256 hosts (40% complete)
    [*] Scanned 128 of 256 hosts (50% complete)
    [*] Scanned 154 of 256 hosts (60% complete)
    [*] Scanned 181 of 256 hosts (70% complete)
    [*] Scanned 206 of 256 hosts (80% complete)
    [*] Scanned 231 of 256 hosts (90% complete)
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002222848324.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**3、基于scanner/ftp/ftp\_version发现FTP服务**

    msf auxiliary(scanner/ftp/ftp_version) > show options 
    ​
    Module options (auxiliary/scanner/ftp/ftp_version): 
    ​
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    FTPPASS mozilla@example.com no The password for the specified username
    FTPUSER anonymous no The username to authenticate as
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    RPORT 21 yes The target port (TCP)
    THREADS 50 yes The number of concurrent threads 
    ​
    msf auxiliary(scanner/ftp/ftp_version) > exploit 
    ​
    [*] Scanned 51 of 256 hosts (19% complete)
    [*] Scanned 52 of 256 hosts (20% complete)
    [*] Scanned 100 of 256 hosts (39% complete)
    [+] 192.168.1.119:21 ‐ FTP Banner: '220 Microsoft FTP Service\x0d\x0a'
    [*] Scanned 103 of 256 hosts (40% complete)
    [*] Scanned 133 of 256 hosts (51% complete)
    [*] Scanned 183 of 256 hosts (71% complete)
    [*] Scanned 197 of 256 hosts (76% complete)
    [*] Scanned 229 of 256 hosts (89% complete)
    [*] Scanned 231 of 256 hosts (90% complete)
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002222922235.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**4、基于scanner/discovery/arp\_sweep发现内网存活主机**

    msf auxiliary(scanner/discovery/arp_sweep) > show options 
    
    Module options (auxiliary/scanner/discovery/arp_sweep): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    INTERFACE no The name of the interface
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    SHOST no Source IP Address
    SMAC no Source MAC Address
    THREADS 50 yes The number of concurrent threads
    TIMEOUT 5 yes The number of seconds to wait for new data 
    
    msf auxiliary(scanner/discovery/arp_sweep) > exploit 
    
    [+] 192.168.1.1 appears to be up (UNKNOWN).
    [+] 192.168.1.2 appears to be up (UNKNOWN).
    [+] 192.168.1.119 appears to be up (VMware, Inc.).
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002222945816.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**5、基于scanner/discovery/udp\_sweep发现内网存活主机**

    msf auxiliary(scanner/discovery/udp_sweep) > show options 
    
    Module options (auxiliary/scanner/discovery/udp_sweep): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    BATCHSIZE 256 yes The number of hosts to probe in each set
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    THREADS 50 yes The number of concurrent threads 
    
    msf auxiliary(scanner/discovery/udp_sweep) > exploit 
    
    [*] Sending 13 probes to 192.168.1.0‐>192.168.1.255 (256 hosts)
    [*] Discovered DNS on 192.168.1.1:53 (ce2a8500000100010000000007564552  53494f4e0442494e440000100003c00c0010000300000001001a19737572656c7920796f7
    5206d757374206265206a6f6b696e67)
    [*] Discovered NetBIOS on 192.168.1.2:137 (JOHN‐PC:<00>:U :WORKGROUP:<00>:G :JOHN‐PC:<20>:U :WORKGROUP:<1e>:G :WORKGROUP:<1d>:U
    :__MSBROWSE__ <01>:G :4c:cc:6a:e3:51:27)
    [*] Discovered NetBIOS on 192.168.1.119:137 (WIN03X64:<00>:U :WIN03X64:<20>:U :WORKGROUP:<00>:G :WORKGROUP:<1e>:G :WIN03X64:<03>:U
    :ADMINISTRA TOR:<03>:U :WIN03X64:<01>:U :00:0c:29:85:d6:7d)
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F2020100222301058.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
参考文章：

    https://micro8.gitbook.io/micro8/contents-1/21-30/23-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-yi-ji
    
        

* * *

#### 5.4.2 基于MSF发现内网存活主机（2）

攻击机： 192.168.1.5 Debian

靶机： 192.168.1.2 Windows 7

192.168.1.115 Windows 2003

192.168.1.119 Windows 2003

**（1）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：**

    auxiliary/scanner/discovery/arp_sweep 
    auxiliary/scanner/discovery/udp_sweep
    auxiliary/scanner/ftp/ftp_version 
    auxiliary/scanner/http/http_version
    auxiliary/scanner/smb/smb_version
    
        

**（2）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：**

    auxiliary/scanner/ssh/ssh_version 
    auxiliary/scanner/telnet/telnet_version
    auxiliary/scanner/discovery/udp_probe 
    auxiliary/scanner/dns/dns_amp
    auxiliary/scanner/mysql/mysql_version
    
        

**6、基于auxiliary/scanner/ssh/ssh\_version发现SSH服务**

    msf auxiliary(scanner/ssh/ssh_version) > show options 
    
    Module options (auxiliary/scanner/ssh/ssh_version): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    RPORT 22 yes The target port (TCP)
    THREADS 50 yes The number of concurrent threads
    TIMEOUT 30 yes Timeout for the SSH probe 
    
    msf auxiliary(scanner/ssh/ssh_version) > exploit 
    
    [+] 192.168.1.5:22 ‐ SSH server version: SSH‐2.0‐OpenSSH_7.9p1 Debian‐5 ( service.version=7.9p1 openssh.comment=Debian‐5 service.vendor=OpenBSD
    service.family=OpenSSH service.product=OpenSSH service.cpe23=cpe:/a:openb
    sd:openssh:7.9p1 os.vendor=Debian os.family=Linux os.product=Linux os.cpe
    23=cpe:/o:debian:debian_linux:‐ service.protocol=ssh fingerprint_db=ssh.banner )
    [*] Scanned 52 of 256 hosts (20% complete)
    [*] Scanned 95 of 256 hosts (37% complete)
    [*] Scanned 100 of 256 hosts (39% complete)
    [*] Scanned 103 of 256 hosts (40% complete)
    [*] Scanned 131 of 256 hosts (51% complete)
    [*] Scanned 154 of 256 hosts (60% complete)
    [*] Scanned 180 of 256 hosts (70% complete)
    [*] Scanned 206 of 256 hosts (80% complete)
    [*] Scanned 235 of 256 hosts (91% complete)
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002223220682.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**7、基于auxiliary/scanner/telnet/telnet\_version发现TELNET服务**

    msf auxiliary(scanner/telnet/telnet_version) > show options 
    
    Module options (auxiliary/scanner/telnet/telnet_version): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    PASSWORD no The password for the specified username
    RHOSTS 192.168.1.119 yes The target address range or CIDR identifier
    RPORT 23 yes The target port (TCP)
    THREADS 50 yes The number of concurrent threads
    TIMEOUT 30 yes Timeout for the Telnet probe
    USERNAME no The username to authenticate as 
    
    msf auxiliary(scanner/telnet/telnet_version) > exploit 
    
    [+] 192.168.1.119:23 ‐ 192.168.1.119:23 TELNET Welcome to Microsoft Telnet Service \x0a\x0a\x0dlogin:
    [*] Scanned 1 of 1 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002223250181.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**8、基于scanner/discovery/udp\_probe发现内网存活主机**

    msf auxiliary(scanner/discovery/udp_probe) > show options 
    
    Module options (auxiliary/scanner/discovery/udp_probe): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    CHOST no The local client address
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    THREADS 50 yes The number of concurrent threads 
    
    msf auxiliary(scanner/discovery/udp_probe) > exploit 
    
    [+] Discovered NetBIOS on 192.168.1.2:137 (JOHN‐PC:<00>:U :WORKGROUP:
    <00>:G :JOHN‐PC:<20>:U :WORKGROUP:<1e>:G :WORKGROUP:<1d>:U
    :__MSBROWSE__ <01>:G :4c:cc:6a:e3:51:27)
    [+] Discovered DNS on 192.168.1.1:53 (de778500000100010000000007564552  53494f4e0442494e440000100003c00c0010000300000001001a19737572656c7920796f7
    5206d757374206265206a6f6b696e67)
    [*] Scanned 43 of 256 hosts (16% complete)
    [*] Scanned 52 of 256 hosts (20% complete)
    [*] Scanned 89 of 256 hosts (34% complete)
    [+] Discovered NetBIOS on 192.168.1.119:137 (WIN03X64:<00>:U :WIN03X64:<20>:U :WORKGROUP:<00>:G :WORKGROUP:<1e>:G :WIN03X64:<03>:U
    :ADMINISTRA TOR:<03>:U :WIN03X64:<01>:U :00:0c:29:85:d6:7d)
    [*] Scanned 103 of 256 hosts (40% complete)
    [*] Scanned 140 of 256 hosts (54% complete)
    [*] Scanned 163 of 256 hosts (63% complete)
    [*] Scanned 184 of 256 hosts (71% complete)
    [*] Scanned 212 of 256 hosts (82% complete)
    [*] Scanned 231 of 256 hosts (90% complete)
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002223321107.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**9、基于auxiliary/scanner/dns/dns\_amp发现内网存活主机**

    msf auxiliary(scanner/dns/dns_amp) > show options 
    
    Module options (auxiliary/scanner/dns/dns_amp): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    BATCHSIZE 256 yes The number of hosts to probe in each set
    DOMAINNAME isc.org yes Domain to use for the DNS request
    FILTER no The filter string for capturing traffic
    INTERFACE no The name of the interface
    PCAPFILE no The name of the PCAP capture file to process
    QUERYTYPE ANY yes Query type(A, NS, SOA, MX, TXT, AAAA, RRSIG, DNSKEY, ANY)
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    RPORT 53 yes The target port (UDP)
    SNAPLEN 65535 yes The number of bytes to capture
    THREADS 50 yes The number of concurrent threads
    TIMEOUT 500 yes The number of seconds to wait for new data 
    
    msf auxiliary(scanner/dns/dns_amp) > exploit 
    
    [*] Sending DNS probes to 192.168.1.0‐>192.168.1.255 (256 hosts)
    [*] Sending 67 bytes to each host using the IN ANY isc.org request
    [+] 192.168.1.1:53 ‐ Response is 530 bytes [7.91x Amplification]
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002223343913.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**10、基于auxiliary/scanner/mysql/mysql\_version发现mysql服务**

    msf auxiliary(scanner/mysql/mysql_version) > show options 
    
    Module options (auxiliary/scanner/mysql/mysql_version): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    RHOSTS 192.168.1.115 yes The target address range or CIDR identifier
    RPORT 3306 yes The target port (TCP)
    THREADS 50 yes The number of concurrent threads 
    
    msf auxiliary(scanner/mysql/mysql_version) > exploit 
    
    [+] 192.168.1.115:3306 ‐ 192.168.1.115:3306 is running MySQL 5.1.52‐community (protocol 10)
    [*] Scanned 1 of 1 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F2020100222340898.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
参考文章:

    https://micro8.gitbook.io/micro8/contents-1/21-30/24-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-er-ji
    
        

* * *

#### 5.4.3 基于MSF发现内网存活主机（3）

攻击机： 192.168.1.5 Debian 靶机： 192.168.1.2 Windows 7

192.168.1.115 Windows 2003

192.168.1.119 Windows 2003

**（1）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：**

    auxiliary/scanner/discovery/arp_sweep 
    auxiliary/scanner/discovery/udp_sweep
    auxiliary/scanner/ftp/ftp_version 
    auxiliary/scanner/http/http_version
    auxiliary/scanner/smb/smb_version
    
        

**（2）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：**

    auxiliary/scanner/ssh/ssh_version 
    auxiliary/scanner/telnet/telnet_version
    auxiliary/scanner/discovery/udp_probe 
    auxiliary/scanner/dns/dns_amp
    auxiliary/scanner/mysql/mysql_version
    
        

**（3）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：**

    auxiliary/scanner/netbios/nbname 
    auxiliary/scanner/http/title
    auxiliary/scanner/db2/db2_version 
    auxiliary/scanner/portscan/ack
    auxiliary/scanner/portscan/tcp
    
        

**11、基于auxiliary/scanner/netbios/nbname发现内网存活主机**

    msf auxiliary(scanner/netbios/nbname) > show options 
    
    Module options (auxiliary/scanner/netbios/nbname): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    BATCHSIZE 256 yes The number of hosts to probe in each set
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    RPORT 137 yes The target port (UDP)
    THREADS 50 yes The number of concurrent threads 
    
    msf auxiliary(scanner/netbios/nbname) > exploit 
    
    [*] Sending NetBIOS requests to 192.168.1.0‐>192.168.1.255 (256 hosts)
    [+] 192.168.1.2 [JOHN‐PC] OS:Windows Names:(JOHN‐PC, WORKGROUP, __MSBROWSE__) Addresses:(192.168.1.2, 192.168.163.1, 192.168.32.1)Mac:4c:cc:6a:e3:51:27
    [+] 192.168.1.115 [VM_2003X86] OS:Windows Names:(VM_2003X86,WORKGROUP) Addresses:(192.168.1.115) Mac:00:0c:29:af:ce:cc Virtual Machine:VMWare
    [+] 192.168.1.119 [WIN03X64] OS:Windows User:ADMINISTRATOR Names:(WIN03X64, WORKGROUP, ADMINISTRATOR) Addresses:(192.168.1.119)Mac:00:0c:29:85:d6:7d Virtual Machine:VMWare
    [*] Scanned 256 of 256 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002223620487.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**12、基于auxiliary/scanner/http/title发现内网存活主机**

    msf auxiliary(scanner/http/title) > show options 
    
    Module options (auxiliary/scanner/http/title): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    Proxies no A proxy chain of format type:host:port[,type:host:port] [...]
    RHOSTS 192.168.1.115,119 yes The target address range or CIDR identifier
    RPORT 80 yes The target port (TCP)
    SHOW_TITLES true yes Show the titles on the console as they are grabbed
    SSL false no Negotiate SSL/TLS for outgoing connections
    STORE_NOTES true yes Store the captured information in notes. Use "no tes‐t http.title" to view
    TARGETURI / yes The base path
    THREADS 50 yes The number of concurrent threads 
    
    msf auxiliary(scanner/http/title) > exploit 
    
    [*] [192.168.1.115:80] [C:200] [R:] [S:Microsoft‐IIS/6.0] 协同管理系统
    [*] Scanned 2 of 2 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002223651141.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**13、基于auxiliary/scanner/db2/db2\_version发现db2服务**

    msf auxiliary(scanner/http/title) > use auxiliary/scanner/db2/db2_version
    msf auxiliary(scanner/db2/db2_version) > show options 
    ​
    Module options (auxiliary/scanner/db2/db2_version): 
    ​
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    DATABASE toolsdb yes The name of the target database
    RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier
    RPORT 50000 yes The target port (TCP)
    THREADS 50 yes The number of concurrent threads
    TIMEOUT 5 yes Timeout for the DB2 probe 
    ​
    msf auxiliary(scanner/db2/db2_version) > exploit
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002223711223.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**14、基于auxiliary/scanner/portscan/ack发现内网存活主机**

    msf auxiliary(scanner/portscan/ack) > show options 
    
    Module options (auxiliary/scanner/portscan/ack): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    BATCHSIZE 256 yes The number of hosts to scan per set
    DELAY 0 yes The delay between connections, per thread, in milliseconds
    INTERFACE no The name of the interface
    JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.
    PORTS 445 yes Ports to scan (e.g. 22‐25,80,110‐900)
    RHOSTS 192.168.1.115,119 yes The target address range or CIDR identifier
    SNAPLEN 65535 yes The number of bytes to capture
    THREADS 50 yes The number of concurrent threads
    TIMEOUT 500 yes The reply read timeout in milliseconds 
    
    msf auxiliary(scanner/portscan/ack) > exploit 
    
    [*] TCP UNFILTERED 192.168.1.115:445
    [*] TCP UNFILTERED 192.168.1.119:445
    [*] Scanned 2 of 2 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002223734128.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**15、基于auxiliary/scanner/portscan/tcp发现内网存活主机**

    msf auxiliary(scanner/portscan/tcp) > show options 
    
    Module options (auxiliary/scanner/portscan/tcp): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    CONCURRENCY 10 yes The number of concurrent ports to check per host
    DELAY 0 yes The delay between connections, per thread, in milliseconds
    JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.
    PORTS 445 yes Ports to scan (e.g. 22‐25,80,110‐900)
    RHOSTS 192.168.1.115,119,2 yes The target address range or CIDR identifier
    THREADS 50 yes The number of concurrent threads
    TIMEOUT 1000 yes The socket connect timeout in milliseconds
    
    msf auxiliary(scanner/portscan/tcp) > exploit 
    
    [+] 192.168.1.2: ‐ 192.168.1.2:445 ‐ TCP OPEN
    [*] Scanned 1 of 3 hosts (33% complete)
    [+] 192.168.1.119: ‐ 192.168.1.119:445 ‐ TCP OPEN
    [+] 192.168.1.115: ‐ 192.168.1.115:445 ‐ TCP OPEN
    [*] Scanned 3 of 3 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002223756453.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
参考文章:

    https://micro8.gitbook.io/micro8/contents-1/21-30/25-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-san-ji
    
        

* * *

#### 5.4.4 基于MSF发现内网存活主机（4）

攻击机： 192.168.1.5 Debian

靶机： 192.168.1.2 Windows 7

192.168.1.115 Windows 2003

192.168.1.119 Windows 2003

**（1）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：**

    auxiliary/scanner/discovery/arp_sweep 
    auxiliary/scanner/discovery/udp_sweep
    auxiliary/scanner/ftp/ftp_version 
    auxiliary/scanner/http/http_version
    auxiliary/scanner/smb/smb_version
    
        

**（2）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：**

    auxiliary/scanner/ssh/ssh_version 
    auxiliary/scanner/telnet/telnet_version
    auxiliary/scanner/discovery/udp_probe
    auxiliary/scanner/dns/dns_amp
    auxiliary/scanner/mysql/mysql_version
    
        

**（3）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：**

    auxiliary/scanner/netbios/nbname 
    auxiliary/scanner/http/title
    auxiliary/scanner/db2/db2_version 
    auxiliary/scanner/portscan/ack
    auxiliary/scanner/portscan/tcp
    
        

**（4）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：**

    auxiliary/scanner/portscan/syn 
    auxiliary/scanner/portscan/ftpbounce
    auxiliary/scanner/portscan/xmas 
    auxiliary/scanner/rdp/rdp_scanner
    auxiliary/scanner/smtp/smtp_version
    
        

**16、基于auxiliary/scanner/portscan/syn发现内网存活主机**

    msf auxiliary(scanner/portscan/syn) > show options 
    
    Module options (auxiliary/scanner/portscan/syn): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    BATCHSIZE 256 yes The number of hosts to scan per set
    DELAY 0 yes The delay between connections, per thread, in millisecond s
    INTERFACE no The name of the interface
    JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.
    PORTS 445 yes Ports to scan (e.g. 22‐25,80,110‐900)
    RHOSTS 192.168.1.115 yes The target address range or CIDR identifier
    SNAPLEN 65535 yes The number of bytes to capture
    THREADS 50 yes The number of concurrent threads
    TIMEOUT 500 yes The reply read timeout in milliseconds 
    
    msf auxiliary(scanner/portscan/syn) > exploit 
    
    [+] TCP OPEN 192.168.1.115:445
    
    [*] Scanned 1 of 1 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F2020100222404361.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**17、基于auxiliary/scanner/portscan/ftpbounce发现内网存活主机**

    msf auxiliary(scanner/portscan/ftpbounce) > show options 
    
    Module options (auxiliary/scanner/portscan/ftpbounce): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    BOUNCEHOST 192.168.1.119 yes FTP relay host
    BOUNCEPORT 21 yes FTP relay port
    DELAY 0 yes The delay between connections, per thread, in millisecond s
    FTPPASS mozilla@example.com no The password for the specified usernam e
    FTPUSER anonymous no The username to authenticate as
    JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.
    PORTS 22‐25 yes Ports to scan (e.g. 22‐25,80,110‐900)
    RHOSTS 192.168.1.119 yes The target address range or CIDR identifier
    THREADS 50 yes The number of concurrent threads 
    
    msf auxiliary(scanner/portscan/ftpbounce) > exploit 
    
    [+] 192.168.1.119:21 ‐ TCP OPEN 192.168.1.119:22
    [+] 192.168.1.119:21 ‐ TCP OPEN 192.168.1.119:23
    [+] 192.168.1.119:21 ‐ TCP OPEN 192.168.1.119:24
    [+] 192.168.1.119:21 ‐ TCP OPEN 192.168.1.119:25
    [*] 192.168.1.119:21 ‐ Scanned 1 of 1 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224103928.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**18、基于auxiliary/scanner/portscan/xmas发现内网存活主机**

    msf auxiliary(scanner/portscan/xmas) > show options 
    
    Module options (auxiliary/scanner/portscan/xmas): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    BATCHSIZE 256 yes The number of hosts to scan per set
    DELAY 0 yes The delay between connections, per thread, in millisecond s
    INTERFACE no The name of the interface
    JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.
    PORTS 80 yes Ports to scan (e.g. 22‐25,80,110‐900)
    RHOSTS 192.168.1.119 yes The target address range or CIDR identifier
    SNAPLEN 65535 yes The number of bytes to capture
    THREADS 50 yes The number of concurrent threads
    TIMEOUT 500 yes The reply read timeout in milliseconds 
    
    msf auxiliary(scanner/portscan/xmas) > exploit
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224128192.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**19、基于auxiliary/scanner/rdp/rdp\_scanner发现内网存活主机**

    msf auxiliary(scanner/rdp/rdp_scanner) > show options 
    
    Module options (auxiliary/scanner/rdp/rdp_scanner): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    CredSSP true yes Whether or not to request CredSSP
    EarlyUser false yes Whether to support Earlier User Authorization Result PDU
    RHOSTS 192.168.1.2,115,119 yes The target address range or CIDR identifier
    RPORT 3389 yes The target port (TCP)
    THREADS 50 yes The number of concurrent threads
    TLS true yes Wheter or not request TLS security 
    
    msf auxiliary(scanner/rdp/rdp_scanner) > exploit 
    
    [*] Scanned 1 of 3 hosts (33% complete)
    [+] 192.168.1.115:3389 ‐ Identified RDP
    [*] Scanned 2 of 3 hosts (66% complete)
    [+] 192.168.1.119:3389 ‐ Identified RDP
    [*] Scanned 3 of 3 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224149733.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**20、基于auxiliary/scanner/smtp/smtp\_version发现内网存活主机**

    msf auxiliary(scanner/smtp/smtp_version) > show options 
    
    Module options (auxiliary/scanner/smtp/smtp_version): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    RHOSTS 192.168.1.5 yes The target address range or CIDR identifier
    RPORT 25 yes The target port (TCP)
    THREADS 50 yes The number of concurrent threads
    
    msf auxiliary(scanner/smtp/smtp_version) > exploit
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224211275.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
参考文章：

    https://micro8.gitbook.io/micro8/contents-1/21-30/26-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-si-ji
    
        

* * *

#### 5.4.5 基于MSF发现内网存活主机（5）

攻击机：-
192.168.1.102 Debian

靶机：-
192.168.1.2 Windows 7-
192.168.1.115 Windows 2003-
192.168.1.119 Windows 2003

（1）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：

    auxiliary/scanner/discovery/arp_sweep 
    auxiliary/scanner/discovery/udp_sweep
    auxiliary/scanner/ftp/ftp_version 
    auxiliary/scanner/http/http_version
    auxiliary/scanner/smb/smb_version
    
        

（2）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：

    auxiliary/scanner/ssh/ssh_version 
    auxiliary/scanner/telnet/telnet_version
    auxiliary/scanner/discovery/udp_probe 
    auxiliary/scanner/dns/dns_amp
    auxiliary/scanner/mysql/mysql_version
    
        

（3）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：

    auxiliary/scanner/netbios/nbname 
    auxiliary/scanner/http/title
    auxiliary/scanner/db2/db2_version 
    auxiliary/scanner/portscan/ack
    auxiliary/scanner/portscan/tcp
    
        

（4）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：

    auxiliary/scanner/portscan/syn 
    auxiliary/scanner/portscan/ftpbounce
    auxiliary/scanner/portscan/xmas 
    auxiliary/scanner/rdp/rdp_scanner
    auxiliary/scanner/smtp/smtp_version
    
        

（5）主要介绍scanner下的三个模块，以及db\_nmap辅助发现内网存活主机，分别为：

    auxiliary/scanner/pop3/pop3_version
    auxiliary/scanner/postgres/postgres_version 
    auxiliary/scanner/ftp/anonymous
    db_nmap
    
        

**21、基于auxiliary/scanner/pop3/pop3\_version发现内网存活主机**

    msf auxiliary(scanner/pop3/pop3_version) > show options 
    
    Module options (auxiliary/scanner/pop3/pop3_version): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    RHOSTS 192.168.1.110‐120 yes The target address range or CIDR identifier
    RPORT 110 yes The target port (TCP)
    THREADS 50 yes The number of concurrent threads 
    
    msf auxiliary(scanner/pop3/pop3_version) > exploit 
    
    [*] Scanned 5 of 11 hosts (45% complete)
    [*] Scanned 11 of 11 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224415665.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**22、基于auxiliary/scanner/postgres/postgres\_version发现内网存活主机**

    msf auxiliary(scanner/postgres/postgres_version) > show options 
    
    Module options (auxiliary/scanner/postgres/postgres_version): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    DATABASE template1 yes The database to authenticate against
    PASSWORD msf no The password for the specified username. Leave blank for a random password.
    RHOSTS 127.0.0.1 yes The target address range or CIDR identifier
    RPORT 5432 yes The target port
    THREADS 50 yes The number of concurrent threads
    USERNAME msf yes The username to authenticate as
    VERBOSE false no Enable verbose output 
    
    msf auxiliary(scanner/postgres/postgres_version) > exploit 
    
    [*] 127.0.0.1:5432 Postgres ‐ Version PostgreSQL 9.6.6 on x86_64‐pc‐li
    nux‐gnu, compiled by gcc (Debian 4.9.2‐10) 4.9.2, 64‐bit (Post‐Auth)
    [*] Scanned 1 of 1 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F2020100222444133.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**23、基于auxiliary/scanner/ftp/anonymous发现内网存活主机**

    msf auxiliary(scanner/ftp/anonymous) > show options 
    
    Module options (auxiliary/scanner/ftp/anonymous): 
    
    Name Current Setting Required Description
    ‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐
    FTPPASS mozilla@example.com no The password for the specified username
    FTPUSER anonymous no The username to authenticate as
    RHOSTS 192.168.1.100‐120 yes The target address range or CIDR identifier
    RPORT 21 yes The target port (TCP)
    THREADS 50 yes The number of concurrent threads 
    
    msf auxiliary(scanner/ftp/anonymous) > exploit 
    
    [+] 192.168.1.115:21 ‐ 192.168.1.115:21 ‐ Anonymous READ (220 Slyar Ftpserver)
    [+] 192.168.1.119:21 ‐ 192.168.1.119:21 ‐ Anonymous READ (220 FTPserver)
    [*] Scanned 3 of 21 hosts (14% complete)
    [*] Scanned 6 of 21 hosts (28% complete)
    [*] Scanned 17 of 21 hosts (80% complete)
    [*] Scanned 21 of 21 hosts (100% complete)
    [*] Auxiliary module execution completed
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224502526.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**24、基于db\_nmap发现内网存活主机**-
MSF内置强大的端口扫描工具Nmap，为了更好的区别，内置命令为：db\_nmap，并且会自动存储nmap扫描结果到数据库中，方便快速查询已知存活主机，以及更快捷的进行团队协同作战，使用方法与nmap一致。也是在实战中最常用到的发现内网存活主机方式之一

例：

    msf exploit(multi/handler) > db_nmap ‐p 445 ‐T4 ‐sT 192.168.1.115‐120
    ‐‐open
    [*] Nmap: Starting Nmap 7.70 ( https://nmap.org ) at 2019‐02‐17 15:17 EST
    [*] Nmap: Nmap scan report for 192.168.1.115
    [*] Nmap: Host is up (0.0025s latency).
    [*] Nmap: PORT STATE SERVICE
    [*] Nmap: 445/tcp open microsoft‐ds
    [*] Nmap: MAC Address: 00:0C:29:AF:CE:CC (VMware)
    [*] Nmap: Nmap scan report for 192.168.1.119
    [*] Nmap: Host is up (0.0026s latency).
    [*] Nmap: PORT STATE SERVICE
    [*] Nmap: 445/tcp open microsoft‐ds
    [*] Nmap: MAC Address: 00:0C:29:85:D6:7D (VMware)
    [*] Nmap: Nmap done: 6 IP addresses (2 hosts up) scanned in 13.35 seconds
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224539476.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
命令hosts查看数据库中已发现的内网存活主机

    msf exploit(multi/handler) > hosts 
    
    Hosts
    ===== 
    
    address mac name os_name os_flavor os_sp purpose info comments
    ‐‐‐‐‐‐‐ ‐‐‐ ‐‐‐‐ ‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐ ‐‐‐‐‐‐‐ ‐‐‐‐ ‐‐‐‐‐‐‐‐
    1.34.37.188 firewall
    10.0.0.2 00:24:1d:dc:3b:16
    10.0.0.3 00:e0:81:bf:b9:7b
    10.0.0.4 00:30:6e:ca:10:b8
    10.0.0.5 9c:8e:99:c4:63:74 2013XXXXX Windows 2008 SP1 client
    ...
    10.0.0.242 00:13:57:01:d4:71
    10.0.0.243 00:13:57:01:d4:73
    ....
    10.162.110.30 firewall
    59.125.110.178 firewall
    127.0.0.1 Unknown device
    172.16.204.8 WIN‐6FEAACQJ691 Windows 2012 server
    172.16.204.9 WIN‐6FEAACQJ691 Windows 2012 server
    172.16.204.21 IDS Windows 2003 SP2 server
    192.168.1.5 JOHN‐PC Windows 7 SP1 client
    192.168.1.101 JOHN‐PC Windows 7 Ultimate SP1 client
    192.168.1.103 LAPTOP‐9994K8RP Windows 10 client
    192.168.1.115 00:0c:29:af:ce:cc VM_2003X86 Windows 2003 SP2 server
    192.168.1.116 WIN‐S4H51RDJQ3M Windows 2012 server
    192.168.1.119 00:0c:29:85:d6:7d WIN03X64 Windows 2003 SP2 server
    192.168.1.254 Unknown device
    192.168.50.30 WINDOWS‐G4MMTV8 Windows 7 SP1 client
    192.168.100.2 Unknown device
    192.168.100.10
    
        

同样hosts命令也支持数据库中查询与搜索，方便快速对应目标存活主机

    msf exploit(multi/handler) > hosts ‐h
    Usage: hosts [ options ] [addr1 addr2 ...] 
    
    OPTIONS:
    ‐a,‐‐add Add the hosts instead of searching
    ‐d,‐‐delete Delete the hosts instead of searching
    ‐c <col1,col2> Only show the given columns (see list below)
    ‐C <col1,col2> Only show the given columns until the next restart (see list below)
    ‐h,‐‐help Show this help information
    ‐u,‐‐up Only show hosts which are up
    ‐o <file> Send output to a file in csv format
    ‐O <column> Order rows by specified column number
    ‐R,‐‐rhosts Set RHOSTS from the results of the search
    ‐S,‐‐search Search string to filter by
    ‐i,‐‐info Change the info of a host
    ‐n,‐‐name Change the name of a host
    ‐m,‐‐comment Change the comment of a host
    ‐t,‐‐tag Add or specify a tag to a range of hosts
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224613737.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

    msf exploit(multi/handler) > hosts ‐S 192 
    
    Hosts
    ===== 
    
    address mac name os_name os_flavor os_sp purpose info comments
    ‐‐‐‐‐‐‐ ‐‐‐ ‐‐‐‐ ‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐ ‐‐‐‐‐‐‐ ‐‐‐‐ ‐‐‐‐‐‐‐‐
    192.168.1.5 JOHN‐PC Windows 7 SP1 client
    192.168.1.101 JOHN‐PC Windows 7 Ultimate SP1 client
    192.168.1.103 LAPTOP‐9994K8RP Windows 10 client
    192.168.1.115 00:0c:29:af:ce:cc VM_2003X86 Windows 2003 SP2 server
    192.168.1.116 WIN‐S4H51RDJQ3M Windows 2012 server
    192.168.1.119 00:0c:29:85:d6:7d WIN03X64 Windows 2003 SP2 server
    192.168.1.254 Unknown device
    192.168.50.30 WINDOWS‐G4MMTV8 Windows 7 SP1 client
    192.168.100.2 Unknown device
    192.168.100.10
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224626155.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
参考文章：

    https://micro8.gitbook.io/micro8/contents-1/21-30/27-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-wu-ji
    
        

* * *

#### 5.4.6 基于MSF发现内网存活主机（6）

攻击机：-
192.168.1.102 Debian

靶机：-
192.168.1.2 Windows 7-
192.168.1.115 Windows 2003-
192.168.1.119 Windows 2003

（1）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：

    auxiliary/scanner/discovery/arp_sweep 
    auxiliary/scanner/discovery/udp_sweep
    auxiliary/scanner/ftp/ftp_version 
    auxiliary/scanner/http/http_version
    auxiliary/scanner/smb/smb_version
    
        

（2）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：

    auxiliary/scanner/ssh/ssh_version 
    auxiliary/scanner/telnet/telnet_version
    auxiliary/scanner/discovery/udp_probe 
    auxiliary/scanner/dns/dns_amp
    auxiliary/scanner/mysql/mysql_version
    
        

（3）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：

    auxiliary/scanner/netbios/nbname 
    auxiliary/scanner/http/title
    auxiliary/scanner/db2/db2_version 
    auxiliary/scanner/portscan/ack
    auxiliary/scanner/portscan/tcp
    
        

（4）主要介绍scanner下的五个模块，辅助发现内网存活主机，分别为：

    auxiliary/scanner/portscan/syn 
    auxiliary/scanner/portscan/ftpbounce
    auxiliary/scanner/portscan/xmas 
    auxiliary/scanner/rdp/rdp_scanner
    auxiliary/scanner/smtp/smtp_version
    
        

（5）主要介绍scanner下的三个模块，以及db\_nmap辅助发现内网存活主机，分别为：

    auxiliary/scanner/pop3/pop3_version
    auxiliary/scanner/postgres/postgres_version 
    auxiliary/scanner/ftp/anonymous
    db_nmap
    
        

（6）主要介绍post下的六个模块，辅助发现内网存活主机，分别为：

    windows/gather/arp_scanner 
    windows/gather/enum_ad_computers
    windows/gather/enum_computers 
    windows/gather/enum_domain
    windows/gather/enum_domains 
    windows/gather/enum_ad_user_comments
    
        

在实战过程中，许多特殊环境下scanner，db\_nmap不能快速符合实战渗透诉求，尤其在域中的主机存活发现，而post下的模块，弥补了该诉求，以便快速了解域中存活主机

**25、基于windows/gather/arp\_scanner发现内网存活主机**

    meterpreter > run windows/gather/arp_scanner RHOSTS=192.168.1.110‐120 THREADS=20
    
    [*] Running module against VM_2003X86
    [*] ARP Scanning 192.168.1.110‐120
    [+] IP: 192.168.1.115 MAC 00:0c:29:af:ce:cc (VMware, Inc.)
    [+] IP: 192.168.1.119 MAC 00:0c:29:85:d6:7d (VMware, Inc.)
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224822827.png%23pic_center)-
**26、基于windows/gather/enum\_ad\_computers发现域中存活主机**

    meterpreter > run windows/gather/enum_ad_computers
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224846697.png%23pic_center)-
**27、基于windows/gather/enum\_computers发现域中存活主机**

    meterpreter > run windows/gather/enum_computers 
    
    [*] Running module against VM_2003X86
    [‐] This host is not part of a domain.
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224909110.png%23pic_center)-
**28、基于windows/gather/enum\_domain发现域中存活主机**

    meterpreter > run windows/gather/enum_domain
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224932581.png%23pic_center)-
**29、基于windows/gather/enum\_domains 发现域中存活主机**

    meterpreter > run windows/gather/enum_domains 
    ​
    [*] Enumerating DCs for WORKGROUP
    [‐] No Domain Controllers found...
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002224956173.png%23pic_center)-
**30、基于windows/gather/enum\_ad\_user\_comments发现域中存活主机**

    meterpreter > run windows/gather/enum_ad_user_comments
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002225021805.png%23pic_center)-
POST下相关模块如：（列举）不一一介绍

    linux/gather/enum_network
    linux/busybox/enum_hosts
    windows/gather/enum_ad_users
    windows/gather/enum_domain_tokens
    windows/gather/enum_snmp
    
        

至此，MSF发现内网存活主机主要模块介绍与使用完毕…

感谢Micro8大佬！！！

参考文章：

    https://micro8.gitbook.io/micro8/contents-1/21-30/28-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-liu-ji
    
        

* * *

#### 5.4.7 基于sqlDataSourceEnumerator发现内网存活主机

**连载1**

System.Data.SqlClient 命名空间是用于 SQL Server 的 .NET 数据提供程序。在net framework2.0中新增加SqlDataSourceEnumerator 类。提供了一种枚举本地网络内的所有可用 SQL Server 实例机制。微软官方是这样解释的：

SQL Server 2000 和 SQL Server 2005 进行应用程序可以确定在当前网络中的 SQL Server实例存在。SqlDataSourceEnumerator类公开给应用程序开发人员，提供此信息DataTable包含所有可用的服务器的信息。返回此表列出了与列表匹配提供当用户尝试创建新的连接的服务器实例以及Connection Properties对话框中，展开下拉列表，其中包含所有可用的服务器

    PowerShell -Command 
    "[System.Data.Sql.SqlDataSourceEnumerator]::Instance.GetDataSources()"
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002225332987.png%23pic_center)-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201002225339103.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
此种方法，在实战中，不留文件痕迹。并且信息准确，发现主机也可。可应对目前主流安全防御产品!!

参考文章：

    https://micro8.gitbook.io/micro8/contents-1/41-50/50-ji-yu-sqldatasourceenumerator-fa-xian-nei-wang-cun-huo-zhu-ji
    
        

感谢大佬！！Micro8

* * *

#### 5.4.8 基于ICMP发现内网存活主机

**ICMP简介：**

它是TCP/IP协议族的一个子协议，用于在IP主机、路由器之间传递控制消息。控制消息是指网络通不通、主机是否可达、路由是否可用等网络本身的消息。这些控制消息虽然并不传输用户数据，但是对于用户数据的传递起着重要的作用。

**nmap扫描：**

    root@John:~# nmap ‐sP ‐PI 192.168.1.0/24 ‐T4
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003081019711.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

    root@John:~# nmap ‐sn ‐PE ‐T4 192.168.1.0/24
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003081036294.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**CMD下扫描：**

    for /L %P in (1,1,254) DO @ping ‐w 1 ‐n 1 192.168.1.%P | findstr "TTL ="
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003081053682.png%23pic_center)-
**powershell扫描：**

    powershell.exe ‐exec bypass ‐Command "Import‐Module ./Invoke‐TSPingSweep.ps1
    ; Invoke‐TSPingSweep ‐StartAddress 192.168.1.1 ‐EndAddress 192.168.1.254 ‐Resolv
    eHost ‐ScanPort ‐Port 445,135"
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003081112377.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003081117140.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

    D:\>tcping.exe ‐n 1 192.168.1.0 80
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003081130568.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

参考文章：

    https://micro8.gitbook.io/micro8/contents-1/21-30/21-ji-yu-icmp-fa-xian-nei-wang-cun-huo-zhu-ji
    
        

* * *

#### 5.4.9 基于UDP发现内网存活主机

**UDP简介：**

UDP（User Datagram Protocol）是一种无连接的协议，在第四层-传输层，处于IP协议的上一层。UDP有不提供数据包分组、组装和不能对数据包进行排序的缺点，也就是说，当报文发送之后，是无法得知其是否安全完整到达的。

**UDP显著特性：**

1）UDP 缺乏可靠性。UDP 本身不提供确认，超时重传等机制。UDP 数据报可能在网络中被复制，被重新排序，也不保证每个数据报只到达一次。

2）UDP 数据报是有长度的。每个 UDP 数据报都有长度，如果一个数据报正确地到达目的地，那么该数据报的长度将随数据一起传递给接收方。而 TCP 是一个字节流协议，没有任何（协议上的）记录边界。

3）UDP 是无连接的。UDP 客户和服务器之前不必存在长期的关系。大多数的UDP实现中都选择忽略源站抑制差错，在网络拥塞时，目的端无法接收到大量的UDP数据报

4）UDP 支持多播和广播。

**1、nmap扫描**

    root@John:~# nmap -sU -T5 -sV --max-retries 1 192.168.1.100 -p 500
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003081619304.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**2、msf扫描**

    msf > use auxiliary/scanner/discovery/udp_probe
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003081646829.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

    msf > use auxiliary/scanner/discovery/udp_sweep
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F2020100308165936.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**3、unicornscan扫描**

linux下使用推荐

    root@John:~# unicornscan -mU 192.168.1.100
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003081726995.png%23pic_center)-
项目地址：

    https://www.mcafee.com/ca/downloads/free-tools/scanline.aspx
    
        

蓝奏地址：

    https://www.lanzous.com/i32zncf
    
        

win下使用推荐。管理员执行-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082234157.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082240429.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
附录：-
在线基于Nmap的udp扫描：

    https://pentest-tools.com/network-vulnerability-scanning/udp-port-scanner-online-nmap​
    
        

–By Micropoor

参考文章：

    https://micro8.gitbook.io/micro8/contents-1/11-20/12-ji-yu-udp-fa-xian-nei-wang-cun-huo-zhu-ji
    
        

* * *

#### 5.4.10 基于ARP发现内网存活主机

**ARP简介：**

ARP，通过解析网路层地址来找寻数据链路层地址的一个在网络协议包中极其重要的网络传输协议。根据IP地址获取物理地址的一个TCP/IP协议。主机发送信息时将包含目标IP地址的ARP请求广播到网络上的所有主机，并接收返回消息，以此确定目标的物理地址

**1、nmap扫描**

    root@John:~# nmap -sn -PR 192.168.1.1/24
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082439282.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**2、msf扫描**

    msf > use auxiliary/scanner/discovery/arp_sweep
    msf auxiliary(arp_sweep) > show options
    
    Module options (auxiliary/scanner/discovery/arp_sweep):
    
    Name Current Setting Required Description
    ---- --------------- -------- -----------
    INTERFACE no The name of the interface
    RHOSTS yes The target address range or CIDR identifier
    SHOST no Source IP Address
    SMAC no Source MAC Address
    THREADS 1 yes The number of concurrent threads
    TIMEOUT 5 yes The number of seconds to wait for new data
    
    msf auxiliary(arp_sweep) > set RHOSTS 192.168.1.0/24
    RHOSTS => 192.168.1.0/24
    msf auxiliary(arp_sweep) > set THREADS 10
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082457616.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082503847.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**3、netdiscover**

    root@John:~# netdiscover -r 192.168.1.0/24 -i wlan0
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082522954.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F2020100308252831.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
4、arp-scan（linux）-
(推荐)速度与快捷 项目地址：

    https://linux.die.net/man/1/arp-scan
    
        

arp-scan没有内置kali，需要下载安装-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082601877.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082606893.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**5、Powershell**

    c:\tmp>powershell.exe -exec bypass -Command "Import-Module .\arpscan.ps1;Invoke-ARPScan -CIDR 192.168.1.0/24"
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082701388.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**6、arp scannet**-
项目地址：

    https://sourceforge.net/projects/arpscannet/files/arpscannet/arpscannet 0.4/
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082716830.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**7、arp-scan（windows）**

(推荐)速度与快捷

    arp-scan.exe -t 192.168.1.1/24
    
        

项目地址：

    https://github.com/QbsuranAlang/arp-scan-windows-/tree/master/arp-scan （非官方）
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F2020100308275268.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**8、arp-ping.exe**

    arp-ping.exe 192.168.1.100
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003082809772.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**9、其他**

如cain的arp发现，一些开源py，pl脚本等，不一一介绍。

参考文章：

    https://micro8.gitbook.io/micro8/contents-1/11-20/13-ji-yu-arp-fa-xian-nei-wang-cun-huo-zhu-ji#5-powershell
    
        

* * *

#### 5.4.11 基于snmp发现内网存活主机

**SNMP简介：**

SNMP是一种简单网络管理协议，它属于TCP/IP五层协议中的应用层协议，用于网络管理的协议。SNMP主要用于网络设备的管理。SNMP协议主要由两大部分构成：SNMP管理站和SNMP代理。SNMP管理站是一个中心节点，负责收集维护各个SNMP元素的信息，并对这些信息进行处理，最后反馈给网络管理员；而SNMP代理是运行在各个被管理的网络节点之上，负责统计该节点的各项信息，并且负责与SNMP管理站交互，接收并执行管理站的命令，上传各种本地的网络信息。

**nmap扫描：**

    root@John:~# nmap -sU --script snmp-brute 192.168.1.0/24 -T4
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235045631.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**msf扫描：**

    msf > use auxiliary/scanner/snmp/snmp_enum
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235108503.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**项目地址：**

    https://www.mcafee.com/us/downloads/free-tools/snscan.aspx
    
        

依然是一块macafee出品的攻击

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235131768.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**NetCrunch：**

**项目地址：**

    https://www.adremsoft.com/demo/
    
        

内网安全审计工具，包含了DNS审计，ping扫描，端口，网络服务等-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235200989.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**snmp for pl扫描：**

**项目地址：**

    https://github.com/dheiland-r7/snmp
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235225708.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235232604.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**其他扫描：-
snmpbulkwalk：**-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235248105.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
snmp-check：-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235300750.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
snmptest：-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235310829.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**附录：**

    use auxiliary/scanner/snmp/aix_version use auxiliary/scanner/snmp/snmp_enum
    use auxiliary/scanner/snmp/arris_dg950
    use auxiliary/scanner/snmp/snmp_enum_hp_laserjet
    use auxiliary/scanner/snmp/brocade_enumhash use auxiliary/scanner/snmp/snmp_enumshares 
    use auxiliary/scanner/snmp/cambium_snmp_loot use auxiliary/scanner/snmp/snmp_enumusers
    use auxiliary/scanner/snmp/cisco_config_tftp use auxiliary/scanner/snmp/snmp_login
    use auxiliary/scanner/snmp/cisco_upload_file use auxiliary/scanner/snmp/snmp_set
    use auxiliary/scanner/snmp/netopia_enum
    use auxiliary/scanner/snmp/ubee_ddw3611 
    use auxiliary/scanner/snmp/sbg6580_enum
    use auxiliary/scanner/snmp/xerox_workcentre_enumusers
    
        

**其他内网安全审计工具（snmp）：**-
项目地址：https://www.solarwinds.com/topics/snmp-scanner-
项目地址：https://www.netscantools.com/nstpro\_snmp.html

**snmp for pl ：**

Can’t locate NetAddr/IP-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235415641.png%23pic_center)

    root@John:~/Desktop/snmp# wget http://www.cpan.org/modules/by-module/NetAddr/NetAddr-IP-4.078.tar.gz
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235429224.png%23pic_center)

    root@John:~/Desktop/snmp# tar xvzf ./NetAddr-IP-4.078.tar.gz
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235442763.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

    root@John:~/Desktop/snmp# cd NetAddr-IP-4.078/
    root@John:~/Desktop/snmp/NetAddr-IP-4.078# ls
    About-NetAddr-IP.txt Artistic Changes 
    Copying docs IP.pm Lite Makefile.PL 
    MANIFEST MANIFEST.SKIP META.yml t TODO
    root@John:~/Desktop/snmp/NetAddr-IP-4.078# perl Makefile.PL
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235456678.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

    root@John:~/Desktop/snmp/NetAddr-IP-4.078# make
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235508966.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

    root@John:~/Desktop/snmp/NetAddr-IP-4.078# make install
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235522300.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235527804.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
参考文章：

    https://micro8.gitbook.io/micro8/contents-1/11-20/20-ji-yu-snmp-fa-xian-nei-wang-cun-huo-zhu-ji
    
        

* * *

#### 5.4.12 基于netbios发现內网存活主机

**netbios简介：**

IBM公司开发，主要用于数十台计算机的小型局域网。该协议是一种在局域网上的程序可以使用的应用程序编程接口（API），为程序提供了请求低级服务的同一的命令集，作用是为了给局域网提供网络以及其他特殊功能。

系统可以利用WINS服务、广播及Lmhost文件等多种模式将NetBIOS名-——特指基于NETBIOS协议获得计算机名称——解析为相应IP地址，实现信息通讯，所以在局域网内部使用NetBIOS协议可以方便地实现消息通信及资源的共享

**nmap扫描：**

    root@John:~# nmap -sU --script nbstat.nse -p137 192.168.1.0/24 -T4
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235656679.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

* * *

**msf扫描：**

    msf > use auxiliary/scanner/netbios/nbname
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235722258.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

* * *

**nbtscan扫描：**

项目地址：

    http://www.unixwiz.net/tools/nbtscan.html
    
        

**Windows:**

    D:\>nbtscan-1.0.35.exe -m 192.168.1.0/24
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235744470.png%23pic_center)

    D:\>nbtstat -n （推荐）
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235808852.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235817317.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)-
**Linux：（推荐）**

    root@John:~/Desktop/nbtscan# tar -zxvf ./nbtscan-source-1.0.35.tgz（1.5.1版本在附录）
    root@John:~/Desktop/nbtscan# make 
    root@John:~/Desktop/nbtscan# nbtscan -r 192.168.1.0/24
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235838597.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

    root@John:~/Desktop/nbtscan# nbtscan -v -s: 192.168.1.0/24
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F2020100323585318.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

* * *

**NetBScanner：**

项目地址：

    https://www.nirsoft.net/utils/netbios_scanner.html
    
        

![在这里插入图片描述](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fimg-blog.csdnimg.cn%2F20201003235911879.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM0ODAxNzQ1%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center)

附录：-
**nbtscan：**

    NBTscan version 1.5.1. Copyright (C) 1999-2003 Alla Bezroutchko. This is a free software and it comes with absolutely no warranty. You can use,distribute and modify it under terms of GNU GPL.
    
    Usage:
    nbtscan [-v] [-d] [-e] [-l] [-t timeout] [-b bandwidth] [-r] [-q] [-s separator] [-m retransmits] (-f filename)|(<scan_range>)
        -v verbose output. Print all names receivedfrom each host
        -d dump packets. Print whole packet contents.
        -e Format output in /etc/hosts format.
        -l Format output in lmhosts format.Cannot be used with -v, -s or -h options.
        -t timeout wait timeout milliseconds for response.Default 1000.
        -b bandwidth Output throttling. Slow down output so that it uses no more that bandwidth bps. Useful on slow links, so that ougoing queries don't get dropped.
        -r use local port 137 for scans. Win95 boxes respond to this only.You need to be root to use this option on Unix.
        -q Suppress banners and error messages,
        -s separator Script-friendly output. Don't print column and record headers, separate fields with separator.
        -h Print human-readable names for services. Can only be used with -v option.
        -m retransmits Number of retransmits. Default 0.
        -f filename Take IP addresses to scan from file filename.
        -f - makes nbtscan take IP addresses from stdin.
        <scan_range> what to scan. Can either be single IP 
            like 192.168.1.1 or
            range of addresses in one of two forms:
            xxx.xxx.xxx.xxx/xx or xxx.xxx.xxx.xxx-xxx.
    
    Examples:
        nbtscan -r 192.168.1.0/24
            Scans the whole C-class network.
        nbtscan 192.168.1.25-137
            Scans a range from 192.168.1.25 to 192.168.1.137
        nbtscan -v -s : 192.168.1.0/24
            Scans C-class network. Prints results in script-friendly
            format using colon as field separator.  
            Produces output like that:
            192.168.0.1:NT_SERVER:00U
            192.168.0.1:MY_DOMAIN:00G
            192.168.0.1:ADMINISTRATOR:03U
            192.168.0.2:OTHER_BOX:00U
            ...
        nbtscan -f iplist
            Scans IP addresses specified in file iplist.
    
        

**NBTscan version 1.5.1:**

项目地址：

    https://github.com/scallywag/nbtscan
    
        

* * *