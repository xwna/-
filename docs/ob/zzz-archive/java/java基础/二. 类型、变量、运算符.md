## 二. 类型、变量、运算符

###### 1. 字符与字符串

######## 字符值与字符串值

像这样用双引号引起来的值，在 Java 里称为字符串，字符串顾名思义，由多个字符组成，单个字符用单引号表示，例如

```java
jshell> 'a'
$4 ==> 'a'

jshell> "abc"
$5 ==> "abc"
```

* 单引号里必须由一个字符
* 双引号里可以有零个、一个、多个字符



######## 转义字符

比如我需要输出一个单引号字符值，`'''` 这样写行不行？本意是想表示中间的单引号，但遗憾的是java把前两个单引号当成了一对，把它当作了那个空字符了

怎么办呢

为了把真正的单引号跟语法的单引号区分开，需要给它加一个反斜杠标记，告诉java，我想表示真正的单引号，而不是语法中的单引号。试一下。

```shell
jshell> System.out.println("\'")
'
```

这种结合了反斜杠的具有特殊含义的字符，称之为转义字符（Escape Character）

常见的有七个：`\'  \"  \\  \n  \t \b \r`  刚才已经讲过单引号转义了

继续来看几个例子

```java
jshell> System.out.println("\"") // 双引号转义
"

jshell> System.out.println("\\") // 反斜杠本身转义
\

jshell> System.out.println("1\n2") // 换行
1
2

jshell> System.out.println("123\t4") // 缩进
123     4

jshell> System.out.println("123\b4") // 退格
124

jshell> System.out.println("123\r4") // 回车，退格是光标退一格，回车是退到头
423
```



######## 文本块

最后再再来看看文本块，如果有一段文字内，其中需要有很多的转义字符，那么可读性会变得很差，例如

```shell
jshell> System.out.println("床前\"明月\"光，\n疑是地上霜。")
```

因此在 java 14 这个版本引入了文本块来进行改善。

```java
jshell> System.out.println("""
                           床前"明月"光，
                           疑是地上霜。""")
```

文本块本质上还是属于字符串值，由一对 三个双引号作为起始和结束标记，中间如果想表示双引号、换行这两个特殊字符，无需再转义表示

* 一个注意事项是 """ 后需要换个行，不要紧接着写字符。



###### 2. 类型

######## 何为类型

现在让用户输入两个数，求得相加结果

```java
jshell> scanner.nextLine()
1
$22 ==> "1"

jshell> scanner.nextLine()
2
$23 ==> "2"

jshell> $22 + $23
$24 ==> "12"
```

显然，这并不是我们想要的结果，它是输入的值当作了字符串，+ 号执行的是字符串连接操作，解决办法如下

```java
jshell> scanner.nextInt()
1
$25 ==> 1

jshell> scanner.nextInt()
2
$26 ==> 2

jshell> $25 + $26
$27 ==> 3
```



nextLine() 和 nextInt() 返回的类型是不同的

* 前者返回的是字符串，类型为 String，+ 表示两个字符串连接
* 后者返回的是整数，类型为 int，+ 表示两个整数相加



######## 数字类型

| 类型名 | 说明                    | 数字范围                                       | 类型后缀 |
| ------ | ----------------------- | ---------------------------------------------- | -------- |
| byte   | 整数类型，用1个字节表示 | $[-2^7,2^7)$ 即 $[-128,128)$                   |          |
| short  | 整数类型，用2个字节表示 | $[-2^{15},2^{15})$                             |          |
| int    | 整数类型，用4个字节表示 | $[-2^{31},2^{31})$                             |          |
| long   | 整数类型，用8个字节表示 | $[-2^{63},2^{63})$                             | L        |
| float  | 浮点小数，用4个字节表示 | $[-1.9999999 * 2^{127},1.9999999 * 2^{127}]$   | F        |
| double | 浮点小数，用8个字节表示 | $[-1.9999999 * 2^{1023},1.9999999 * 2^{1023}]$ | D        |

* `[]` 包含等于，`()` 不包含等于
* 类型后缀
  * 不区分大小写，但建议用大写，因为小写的 L 与 1 容易混淆
  * 尾符号 D 可以省略

* float 和 double 精度不同，即小数点后的位数
  * float 的精度二进制是 23，换算成十进制是 6~7
  * double 的精度二进制是 52，换算成十进制是 15~16



######## 字符类型

| 类型名 | 说明                           | 范围                         |
| ------ | ------------------------------ | ---------------------------- |
| char   | 字符类型，配合单引号           | $[0,2^{16})$ 即 $[0, 65536)$ |
| String | 字符串类型，配合双引号或文本块 | -                            |



###### 3. 变量与运算符

######## 变量

变量的定义格式为

```java
类型 变量名 = 值;
```

* 从语法可以看到，变量由类型和名称组成，类型决定了变量能存储的数据大小与数据格式，名字用来代表后面的值
* 这个语法其实咱们前面见过类似的，var scanner = new Scanner(System.in)，这里 var 是类型，因为之前我们还没有学习具体有哪些类型，因此使用了 var 来代表某种类型，scanner是变量名，后面这一串就是值，也是 Scanner 对象



= 称之为赋值运算符，可以用来更新变量代表的值。

例如：

```java
int a = 10
```

这行代码的意思是，定义了整型变量a，更新它的初始值为10

再来一句：

```java
a = 20
```

这时候为啥不用写前面的类型了呢，因为变量定义只需一次，定义好之后变量就可以反复使用了，这行代码的意思是，将 a 所代表的值更新为 20



变量可以用来保存运算的结果，它自身也能参与运算



######## 运算符

```java
int a = 5 + 3
```

结果为 8

```java
int a = 5 - 3
```

结果为 2

```java
int a = 5 * 3
```

结果为 15

```java
int a = 5 / 3
```

结果为 1，整数除法有两个注意点

* 整数除法，只会保留商，而小数部分会被舍弃，并不考虑四舍五入
* 除0是不合法的，会出错

```java
int a = 5 % 3
```

结果为 2

小数加减乘除与整数类似，只是小数除法可以保留小数点后的数字，而且可以除零，例如

```java
jshell> 5.0 / 3.0
$40 ==> 1.6666666666666667

jshell> 5.0 / 0.0
$41 ==> Infinity
```



增强赋值运算符

```java
int a = 20; 
a = a + 10; 
```

意思是，获取 a 的原有值 20，执行加 10 运算，将新的结果重新赋值给 a，a 代表的值被更新成了 30。可以用 += 增强赋值运算符达到类似的效果

```java
a += 10;
```

先不要看 = 号，获取 a 的原有值 30，执行加 10 运算，运算的结果 40 赋值给 a

```java
a -= 10;
```

 先拿 a 的原有值 40 与后面的 10 做减法，再将结果 30 赋值给 a



自增自减运算符

两个特殊运算符 ++ 与 -- 

++ 是让变量自增1，-- 是让变量自减1，举个例子

```java
int a = 10;
a++;
```

结果为 11，++ 和 -- 既可以写在变量之前，也可以写在变量之后，这两种写法的区别，我们到高级篇再讲，目前暂不用去了解



###### 4. 练习 - 房贷计算器

【等额本息还款】法计算房贷

> 术语
>
> * 等额本息是指一种贷款的还款方式，是在还款期内，每月偿还同等数额的贷款（包括本金和利息）
>
> * 每月偿还的贷款可以通过下述公式计算
>
>   $p * r * (1 + r)^m / ((1 + r)^m - 1)$
>
>   * p 为贷款本金 principal
>   * r 为月利率 monthlyInterestRate
>   * m 为还款月数 months



公式中这些都是什么意思呢

例如：贷款 200 万元 ，对应公式中的 p，200 万就是贷款本金，年利率 6%，月利率 mr 就是 6% / 12 = 0.5%，假设 10 年还清，这时还款月数就是 360 个月。套入公式计算即可得到每月还多少钱

要完成这个计算，有一点没学过的是求这里的 1+ mr 的 m 次方，计算它需要用一个求幂方法，这个方法是 jdk 核心类库中 Math 这个类提供的，Math的字面意思是数学，Math 类中提供了很多与数学计算相关的方法，如果你以后有这方面需求，就找它。

######## Math.pow()

pow 是 static 方法，语法为 `类名.方法名(参数值)`，它需要两个参数，参数1是底数，参数2是指数

```java
jshell> Math.pow(2.0, 1)
$42 ==> 2.0

jshell> Math.pow(2.0, 2)
$43 ==> 4.0

jshell> Math.pow(2.0, 3)
$44 ==> 8.0
```



解答

打开 idea，编写 Calculator 类

```java
public class Calculator {
    
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println("请输入贷款本金 p");
        double p = scanner.nextDouble();
        
        System.out.println("请输入年利率 r%");
        double yr = scanner.nextDouble();
        double mr = yr / 100.0 / 12.0;
        
        System.out.println("请输入贷款月数 m");
        int m = scanner.nextInt();
        
        System.out.println(p * mr * Math.pow((1 + mr), m) / (Math.pow((1 + mr), m) - 1));
    }
}
```



######## 数字格式化

对结果的数字进行格式化，让它以货币的格式来显示

需要借助核心类库中一个 NumberFormat 对象，字面意思是数字格式化，使用它的 getCurrencyInstance 方法来获取一个货币格式化对象，再使用它的 format 方法把 double 小数格式化为货币格式，格式化时也会保留两位小数

例子

```java
System.out.println(NumberFormat.getCurrencyInstance(Locale.CHINA).format(1000000.00));   System.out.println(NumberFormat.getCurrencyInstance(Locale.US).format(1000000.00));
System.out.println(NumberFormat.getCurrencyInstance(Locale.GERMANY).format(1000000.00));
System.out.println(NumberFormat.getCurrencyInstance(Locale.KOREA).format(1000000.00));
```

输出

```
¥1,000,000.00
$1,000,000.00
1.000.000,00 €
₩1,000,000
```

如果 Locale 省略不写，默认为中国



房贷计算器可以改写为

```java
double payment = p * mr * Math.pow((1 + mr), m) / (Math.pow((1 + mr), m) - 1);       System.out.println(NumberFormat.getCurrencyInstance().format(payment));
```



######## 查阅 Javadoc

练习做完了，大家学到了什么呢？

有同学说，学会怎么算每月还款了，是吗？并不是，通过这个例子，要认识到 java 核心类库能帮我们解决很多问题，比如说求幂运算，比如说数字格式化，包括之前学过的 Scanner 都是核心类库提供的功能，这就提醒我们，要解决某个编程问题之前，要先想一想核心类库有没有这方面的功能，如果有拿来用就行了，不必自己重新实现某项功能的代码，我们是站在巨人的肩膀上进行编程的。

当然，同学们并不是一开始就知道核心类库都提供了哪些功能，因此，这就需要我们不断去熟悉核心类库，熟悉它都有哪些类，哪些方法，比较重要的功能都在后续的课程中都会陆续介绍到，当然呢，同学们也不能总等着老师来喂知识，也可以自己查阅 javadoc 来扩展自己的知识面

javadoc 就是 java documentation 的缩写，我们下载的 jdk 中已经自带了，无需额外再下载。那怎么查阅 javadoc 呢，如果大家用的是 idea，那么可以通过一些快捷键来查阅java文档

* 比如想看看类的文档，这时先按 Ctrl + N 查找类，假设我想看 Math 类的文档，输入要查阅的类名 Math，回车，可以跳转到这个类

  ![image-20220627105939828](image-20220627105939828.png)

* 接下来我想看看方法的文档怎么办呢，按一下 ctrl + f12，列出当前类的所有方法，绿色表示可以使用方法，橙色带锁的，表示是该类一种特殊的私有方法，不能直接使用。找感兴趣的方法时，如果你懂一些英文单词，那么会有一定优势，例如你想找一个平方根方法，它对应的英文是 sqrt，这时敲入这几个字母，就会定位到方法，同样可以用翻译查看该方法的功能

  ![image-20220627110153749](image-20220627110153749.png)

  ![image-20220627110452889](image-20220627110452889.png)

* 可以查到它的作用：返回一个数的平方根，这是方法名，查看后面括号内可以得知，需要一个参数，代表要求平方根的那个数字，是一个double 小数，方法名称前还有个 double 表示它的结果类型也是一个 double 小数

* Math 中的方法大部分都是 static 方法，也就是配合类名使用的方法，之前也说过，用法为 类名.方法名(参数)

在平时写代码时，如果忘记了某个方法的作用，可以光标定位到该方法，按 Ctrl + Q 进行查阅，效果是类似的